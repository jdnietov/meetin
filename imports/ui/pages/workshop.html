<template name="workshop">
  <div class="ui main workshop container">
    <!-- Name header -->
    {{#unless isEditingName}}
    <h1 class="ui header">{{workshop.name}}
      {{#if isUserOwner workshop.owner}}
      <!-- Edit icon -->
      <a href="#"><i class="small edit name icon"></i></a>
      {{/if}}
      <div class="sub header">creado por <a href="/users/{{workshop.owner}}">{{getOwnerName workshop.owner}}</a></div>
    </h1>
    {{else}}
    <!-- Edit input -->
    <div class="ui big edit action input">
      <input type="text" name="wedit-name" value="{{workshop.name}}"/>
      <button class="ui teal icon save name button"><i class="check icon"></i></button>
    </div><br>
    {{/unless}}

    <!-- Attend button -->
    {{#if currentUser}}
      {{#if isUserAttending}}
        <button class="ui dark-blue join workshop labeled icon button">
          <i class="check icon"></i>
          Estás asistiendo
        </button>
      {{else}}
        <button class="ui light-aqua join workshop labeled icon button">
          <i class="right arrow icon"></i>
          Asistir
        </button>
      {{/if}}
    {{/if}}

    <div class="ui workshop info grid">
      <div class="ten wide column">
        <!-- Descripción, tags -->
        <div class="ui segment">
          <!-- Tags -->
          {{#each workshop.tags}}
            <a data-idx="{{@index}}" class="ui label">
              {{this}}
              {{#if isUserOwner workshop.owner}} <i class="delete tag icon"></i> {{/if}}
            </a>
          {{/each}}
          {{#if isUserOwner workshop.owner}}
          <button class="circular ui teal icon mini button">
            <i class="add icon"></i>
          </button>
          {{/if}}
          {{#with workshop.desc}}
          <div class="ui divider"></div>
          <h5 class="ui header">
            ¿Qué se hace en este taller?
            {{#if isUserOwner workshop.owner}}
            <a href="#"><i class="small edit desc icon"></i></a>
            {{/if}}
          </h5>
            {{#if isEditingDesc}}
            <div class="ui desc form">
              <div class="field">
                <textarea name="wedit-desc" rows="6" value="{{this}}" placeholder="Descríbete como persona!"></textarea>
              </div>
              <button class="ui save desc button">Guardar</button>
            </div>
            {{else}}
            <p>{{this}}</p>
            {{/if}}
          {{/with}}
          {{#with workshop.items}}
          <div class="ui divider"></div>
          <h5 class="ui header">
            ¿Qué hay que traer?
            {{#if isUserOwner workshop.owner}}
            <a href="#"><i class="small edit name icon"></i></a>
            {{/if}}
          </h5>
          <div class="ui list">
            {{#each this}}
            <div class="item">
              <i class="check icon"></i>
              <div class="content">
                {{this}}
              </div>
            </div>
            {{/each}}
          </div>
          {{/with}}
        </div>
      </div>
      <div class="six wide column">
        <!-- Participantes -->
        <div class="ui segment">
          <h5 class="ui header">{{lengthOf workshop.participants}} personas asistirán</h5>
          {{#each participantsSliced workshop.participants}}
            <a href="/users/{{this}}">
              <img class="ui avatar image" src="https://semantic-ui.com/images/avatar/small/matt.jpg" alt="">
            </a>
          {{/each}}
          <!-- Información -->
          <h5 class="ui header">Información</h5>
          <div class="ui list">
            <!-- Dirección -->
            <div class="item">
              <i class="home icon"></i>
              <div class="content">
                {{workshop.addr}}
                {{#if isUserOwner workshop.owner}}
                <a href="#"><i class="small edit name icon"></i></a>
                {{/if}}
              </div>
            </div>
            <!-- Precio -->
            <div class="item">
              <i class="dollar icon"></i>
              <div class="content">
                {{workshop.price}}
                {{#if isUserOwner workshop.owner}}
                <a href="#"><i class="small edit name icon"></i></a>
                {{/if}}
              </div>
            </div>
          </div>

          <div class="ui accordion">
            <div class="active title">
              <i class="dropdown icon"></i>
              Más opciones
            </div>
            <div class="content">
              <i class="red trash icon"></i>
              <a class="delete event" href="#">Eliminar este evento</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  {{> confirmDeleteModal workshopName=workshop.name}}
</template>

<template name="confirmDeleteModal">
  <div id="confirmDeleteModal" class="ui compact modal">
    <div class="content">
      <h2 class="ui centered header">¿Estás seguro que deseas eliminar tu taller?</h2>
      <center>
        <p>
          El evento {{workshopName}} será eliminado de forma permanente. ¿Deseas continuar?
        </p>
      </center>
    </div>
    <div class="actions">
      <div class="ui left floated button cancel">Cancelar</div>
      <div class="ui red button ok">Eliminar</div>
    </div>
  </div>
</template>
